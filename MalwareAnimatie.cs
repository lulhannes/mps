using System;
using System.Collections.Generic;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

namespace MPS
{
    public class MalwareAnimatie
    {
        public Apparaat Start { get; private set; }
        public Apparaat Eind { get; private set; }
        public float Hoek { get; private set; }
        public SpriteEffects Effect { get; private set; }
        public Vector2 Positie { get; private set; }
        public bool Klaar { get; private set; }
        public Malware Malware { get; private set; }

        private List<Apparaat> route;
        private int aantal;
        private double procent;

        public MalwareAnimatie(List<Apparaat> route, Malware malware)
        {
            Positie = route[0].Positie;
            Klaar = false;
            Malware = malware;
            this.route = route;
            aantal = route.Count - 1;
            procent = 0;
        }

        public void Update(Double time)
        {
            procent += time / Netwerk.Timer;
            if (procent >= 1)
            {
                Klaar = true;
                return;
            }

            int i = (int)(aantal * procent);
            Start = route[i];
            Eind = route[i + 1];
            Hoek = (float)Math.Atan2(Eind.Positie.Y - Start.Positie.Y, Eind.Positie.X - Start.Positie.X);
            Effect = (Hoek > Math.PI / 2 || Hoek < Math.PI / -2) ? SpriteEffects.FlipVertically : SpriteEffects.None;
            Positie = Start.Positie + (Eind.Positie - Start.Positie) * new Vector2((float)(procent - (float)i / aantal) * aantal);
        }
    }
}