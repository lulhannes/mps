using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MPS
{
    public class Malware
    {
        int firewall;
        int antivirus;

        public Malware(int firewall, int antivirus)
        {
            this.firewall = firewall;
            this.antivirus = antivirus;
        }
        
        public void Infecteer(Apparaat app)
        {
            if (!app.Infecties.Contains(this))
                app.Infecties.Add(this);
        }

        /// <summary>
        /// Laat de malware verspreiden naar alle aanliggende apparaten indien mogelijk.
        /// </summary>
        public void InfecteerBuren()
        {
            // Zoek al geinfecteerde apparaten
            List<Apparaat> appInfected = new List<Apparaat>();
            foreach (Apparaat app in Netwerk.Apparatuur)
            {
                if (app.Infecties.Contains(this))
                    appInfected.Add(app);
            }

            // Infecteer hun aanliggende apparaten
            foreach (Apparaat appInf in appInfected)
            {
                foreach (Apparaat[] bnd in (from bnd in Netwerk.Verbindingen where bnd.Contains(appInf) select bnd))
                {
                    if (bnd[0] != appInf)
                    {
                        Infecteer(bnd[0]);
                    }
                    else
                    {
                        Infecteer(bnd[1]);
                    }
                }
            }
        }
    }
}
